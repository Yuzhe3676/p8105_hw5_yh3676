p8105_hw5_yh3676
================
Yuzhe Hu
2023-11-15

## Problem 2

Create a tidy dataframe containing data from all participants.

``` r
# read all dataframes
combined_df = 
  tibble(
    files = list.files("./data/problem2/"),
    path = str_c("./data/problem2/", files)
  ) |>
  mutate(data = map(path, read_csv)) |>
  unnest()

# tidy the result
tidy_df = 
  combined_df |>
  mutate(
    files = str_replace(files, ".csv", ""),
    arm = str_sub(files, 1, 3),
    subject_id = str_sub(files, 5, 7)) |>
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "value",
    names_prefix = "week_") |>
  mutate(week = as.numeric(week)) |>
  select(arm, subject_id, week, value)
```

Make a spaghetti plot showing observations on each subject over time.

``` r
tidy_df |>
  ggplot(aes(x = week, y = value, color = subject_id)) +
  geom_line() +
  geom_point() + 
  facet_grid(~arm) +
  labs(x = 'Week', y = 'Value', title = 'Spaghetti plot on each subject over time')
```

<img src="p8105_hw5_yh3676_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />

- From the spaghetti plot, the values of the 10 participants in the
  experimental arm has an increasing trend over 8 weeks. In contrast,
  the values of the 10 participants in the control arm do not have this
  trend.

## Problem 3

Simulate for \$ = 0 \$

``` r
t_test = function(mu){
  sim_data = tibble(
    rnorm(n = 30, mean = mu, sd = 5)) 
  
  t_test_result = 
    t.test(sim_data) |>
    broom::tidy() |>
    select(estimate, p.value)
  
  return(t_test_result)
}
  
mu_0 =
  tibble(
    mu = 0,
    iter = 1:5000
  ) |>
  mutate(t_test_df = map(mu, t_test)) |>
  unnest(t_test_df)
```

Simulate for $\mu = \{1, 2, 3, 4, 5, 6\}$

``` r
multimu_result =
  expand_grid(mu = 1:6, iteration = 1:5000) |>
  mutate(multimu_df = map(mu, t_test)) |>
  unnest(multimu_df)
```
